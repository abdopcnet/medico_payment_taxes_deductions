# هل يمكن دفع الفاتورة بالكامل بـ 110 مع خصم 4؟

## السيناريو
- الفاتورة = 114
- استلمت = 110
- تريد خصم = 4
- تريد: الفاتورة مسددة بالكامل

## الحساب

### المعادلة الأساسية (من الكود)

```
paid_amount = allocated_amount + deduction
```

### الحالة الحالية
```
paid_amount = 110
deduction = 4
allocated_amount = ?
```

### لحساب allocated_amount:
```
110 = allocated_amount + 4
allocated_amount = 110 - 4 = 106
```

### النتيجة:
```
الفاتورة = 114
المبلغ المدفوع للفاتورة = 106 (allocated_amount)
المتبقي = 114 - 106 = 8
الفاتورة = "Partly Paid" (متبقي 8)
```

## الخلاصة

❌ **لا يمكن** دفع الفاتورة بالكامل بـ 110 مع خصم 4!

### السبب:
لكي تكون الفاتورة مسددة بالكامل:
```
allocated_amount = 114 (مبلغ الفاتورة الكامل)
```

لكن:
```
paid_amount = allocated_amount + deduction
110 = 114 + 4 = 118 (مستحيل!)
```

## الحلول الممكنة

### الحل 1: استلم 118 (الحل الصحيح)
```
Paid Amount = 118          (110 + 8)
Allocated Amount = 114     (مبلغ الفاتورة الكامل)
Deduction = 4

المعادلة: 118 = 114 + 4 ✓
النتيجة: الفاتورة مسددة بالكامل
```

### الحل 2: خصم 0 (بدون خصم)
```
Paid Amount = 110
Allocated Amount = 110     (جزء من الفاتورة)
Deduction = 0

النتيجة: الفاتورة متبقية 4 (Partly Paid)
```

### الحل 3: خصم أقل (مثلاً 0)
```
Paid Amount = 110
Allocated Amount = 110
Deduction = 0

النتيجة: الفاتورة متبقية 4 (Partly Paid)
```

## القاعدة

**لدفع الفاتورة بالكامل مع خصم:**

```
paid_amount = invoice_grand_total + deduction_amount
```

**في حالتك:**
```
paid_amount = 114 + 4 = 118
```

**إذا استلمت 110 فقط:**
- لا يمكن خصم 4 ودفع الفاتورة بالكامل
- يمكن خصم 0 ودفع 110 (متبقي 4)
- أو خصم أقل (مثلاً 0) ودفع 110 (متبقي 4)

## مثال عملي

**الفاتورة = 114**
**استلمت = 110**
**تريد خصم = 4**

**الواقع:**
- المبلغ المتاح للفاتورة = 110 - 4 = 106
- الفاتورة = 114
- المتبقي = 114 - 106 = 8
- **الفاتورة لن تكون مسددة بالكامل**

**لدفع الفاتورة بالكامل:**
- يجب أن تستلم: 114 + 4 = **118**
- أو خصم: 0 (بدون خصم) ودفع 110 (متبقي 4)

